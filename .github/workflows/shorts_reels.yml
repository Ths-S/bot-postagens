name: Upload YouTube Video

on:
  workflow_dispatch:
  push:
    paths:
      - "videos/pending/**"
      - "upload_youtube.py"

jobs:
  upload:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repositório
        uses: actions/checkout@v3

      - name: Configurar Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.11"

      - name: Instalar dependências
        run: |
          pip install google-auth google-auth-oauthlib google-auth-httplib2 google-api-python-client

      - name: Listar arquivos de vídeo
        run: ls -R videos || echo "⚠️ Nenhuma pasta de vídeos encontrada"

      - name: Rodar upload YouTube
        env:
          YOUTUBE_CLIENT_SECRET_JSON: ${{ secrets.YOUTUBE_CLIENT_SECRET_JSON }}
          YOUTUBE_TOKEN_PICKLE: ${{ secrets.YOUTUBE_TOKEN_PICKLE }}
        run: python -u upload_youtube.py
